import{a as k,t as L}from"../chunks/disclose-version.CJFPsRL-.js";import{c as t,n as J,r as e,s as a,t as M,g as d,h as K,p as R,l as ie,b as ve,a as Q,m as de,d as Z,j as fe}from"../chunks/runtime.CUNFE6o5.js";import{p as G,i as X}from"../chunks/props.D6-fppJ3.js";import{i as Y}from"../chunks/lifecycle.CDJD4jvc.js";import{s as xe,a as be}from"../chunks/store.BcJSs_Hw.js";import{i as ye}from"../chunks/demoMode.ClaLBl7d.js";import{s as p,e as he}from"../chunks/render.YXdxLiCJ.js";import{e as oe,i as le}from"../chunks/Icon.Bvhz2f0e.js";import{s as we}from"../chunks/index.CnPSb7tb.js";import{t as U,s as $e}from"../chunks/class.Cz7S4UMx.js";import{D as ke}from"../chunks/droplet.lEL7--kX.js";import{c as ne}from"../chunks/index-client.Cowl8BPV.js";import{Z as Le}from"../chunks/zap.BJIn6b88.js";import{B as Ce}from"../chunks/battery.CBqZfLjW.js";import{c as Se}from"../chunks/svelte-component.CIsdkGy0.js";import{K as je,S as Te,T as Be,F as De,a as Me}from"../chunks/truck.C69z-cVi.js";var Pe=L('<div class="mt-2 text-sm text-red-600 flex items-center space-x-1"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg> <span> </span></div>'),Fe=L('<div class="p-4"><div class="flex justify-between mb-2"><span class="font-medium capitalize"> </span> <span class="text-sm"> </span></div> <div class="relative h-4 bg-gray-200 rounded overflow-hidden"><div class="absolute top-0 left-0 h-full transition-all duration-500 rounded"></div></div> <!></div>'),We=L('<div class="bg-white rounded-lg shadow"><div class="p-4 border-b"><div class="flex items-center space-x-2"><!> <h2 class="text-lg font-medium">Tank Levels</h2></div></div> <div class="divide-y"></div></div>');function ze(j,x){let o=G(x,"tanks",8);function r(s){return s<=25?"red":s<=50?"yellow":"green"}function i(s,l){return s==="fresh"&&l<=25?"Fresh water low":(s==="grey"||s==="black")&&l>=75?`${s} tank needs emptying`:null}var m=We(),b=t(m),_=t(b),f=t(_);ke(f,{class:"text-blue-500"}),J(2),e(_),e(b);var w=a(b,2);oe(w,5,()=>Object.entries(o()),le,(s,l)=>{let c=()=>d(l)[0],v=()=>d(l)[1];var g=Fe(),y=t(g),n=t(y),u=t(n);e(n);var h=a(n,2),C=t(h);e(h),e(y);var $=a(y,2),S=t($);const D=K(()=>r(v().level)==="red"),H=K(()=>r(v().level)==="yellow"),P=K(()=>r(v().level)==="green");e($);var O=a($,2);X(O,()=>i(c(),v().level),F=>{var T=Pe(),W=a(t(T),2),z=t(W);M(()=>p(z,i(c(),v().level))),e(W),e(T),k(F,T)}),e(g),M(()=>{p(u,`${c()??""} Water`),p(C,`${v().level??""}% of ${v().capacity??""} ${v().unit??""}`),we(S,"style",`width: ${v().level??""}%`),U(S,"bg-red-500",d(D)),U(S,"bg-yellow-500",d(H)),U(S,"bg-green-500",d(P))}),k(s,g)}),e(w),e(m),k(j,m)}var Ee=L('<span class="px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm">Charging</span>'),Ae=L('<div class="bg-white rounded-lg shadow"><div class="p-4 border-b"><div class="flex items-center space-x-2"><!> <h2 class="text-lg font-medium">Power Systems</h2></div></div> <div class="divide-y"><div class="p-4"><div class="flex items-center justify-between mb-4"><div class="flex items-center space-x-3"><!> <div><div class="font-medium">Battery Level</div> <div class="text-2xl font-bold"> </div></div></div> <!></div> <div class="grid grid-cols-2 gap-4"><div class="p-3 bg-gray-50 rounded"><div class="text-sm text-gray-600">Leg 1</div> <div class="font-medium"> </div> <div class="text-sm text-gray-500"> </div></div> <div class="p-3 bg-gray-50 rounded"><div class="text-sm text-gray-600">Leg 2</div> <div class="font-medium"> </div> <div class="text-sm text-gray-500"> </div></div></div></div> <div class="p-4"><div class="flex items-center justify-between mb-4"><div><div class="font-medium">Generator</div> <div class="text-sm text-gray-500"> </div></div> <button> </button></div> <div class="grid grid-cols-2 gap-4"><div class="p-3 bg-gray-50 rounded"><div class="text-sm text-gray-600">Fuel Level</div> <div class="font-medium"> </div></div> <div class="p-3 bg-gray-50 rounded"><div class="text-sm text-gray-600">Output Power</div> <div class="font-medium"> </div></div></div></div></div></div>');function Ge(j,x){R(x,!1);const o=de();let r=G(x,"power",8);const i=ne();function m(B){i("update",{type:"power",subtype:"generator",updates:B})}function b(){const{inverter:B,ac:A}=r(),_e=A.leg1.power+A.leg2.power;return{isCharging:B.charging,powerUsage:_e,batteryLevel:B.batteryLevel}}ie(()=>{},()=>{Z(o,b())}),ve(),Y();var _=Ae(),f=t(_),w=t(f),s=t(w);Le(s,{class:"text-yellow-500"}),J(2),e(w),e(f);var l=a(f,2),c=t(l),v=t(c),g=t(v),y=t(g);Ce(y,{class:"text-blue-500"});var n=a(y,2),u=a(t(n),2),h=t(u);e(u),e(n),e(g);var C=a(g,2);X(C,()=>d(o).isCharging,B=>{var A=Ee();k(B,A)}),e(v);var $=a(v,2),S=t($),D=a(t(S),2),H=t(D);e(D);var P=a(D,2),O=t(P);e(P),e(S);var F=a(S,2),T=a(t(F),2),W=t(T);e(T);var z=a(T,2),ce=t(z);e(z),e(F),e($),e(c);var N=a(c,2),V=t(N),q=t(V),ee=a(t(q),2),ge=t(ee);M(()=>p(ge,`Runtime: ${Math.floor(r().generator.runtime/60)??""}h ${r().generator.runtime%60}m`)),e(ee),e(q);var E=a(q,2),pe=t(E);e(E),e(V);var te=a(V,2),I=t(te),ae=a(t(I),2),ue=t(ae);e(ae),e(I);var re=a(I,2),se=a(t(re),2),me=t(se);e(se),e(re),e(te),e(N),e(l),e(_),M(()=>{p(h,`${d(o).batteryLevel??""}%`),p(H,`${r().ac.leg1.voltage??""}V / ${r().ac.leg1.current??""}A`),p(O,`${r().ac.leg1.power??""}W`),p(W,`${r().ac.leg2.voltage??""}V / ${r().ac.leg2.current??""}A`),p(ce,`${r().ac.leg2.power??""}W`),$e(E,`px-4 py-2 rounded-md font-medium
            ${(r().generator.state==="on"?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200")??""}`),p(pe,`${(r().generator.state==="on"?"Stop":"Start")??""} Generator`),p(ue,`${r().generator.fuelLevel??""}%`),p(me,`${r().generator.outputPower??""}W`)}),he("click",E,()=>m({state:r().generator.state==="on"?"off":"on"})),k(j,_),Q()}var He=L('<div class="p-3 bg-gray-50 rounded flex items-center space-x-3"><!> <div><div class="text-sm text-gray-600"> </div> <div class="font-medium capitalize"> </div></div></div>'),Oe=L('<div class="bg-white rounded-lg shadow"><div class="p-4 border-b"><div class="flex items-center space-x-2"><!> <h2 class="text-lg font-medium">Vehicle Status</h2></div></div> <div class="grid grid-cols-2 gap-4 p-4"></div></div>');function Ve(j,x){R(x,!1);let o=G(x,"vehicle",8);const r=[{icon:je,label:"Ignition",value:o().ignition,colorClass:o().ignition==="on"?"text-green-600":"text-gray-600"},{icon:Te,label:"Park Brake",value:o().parkBrake,colorClass:o().parkBrake==="on"?"text-green-600":"text-red-600"},{icon:Be,label:"Engine Hours",value:`${o().engineHours} hrs`,colorClass:"text-blue-600"},{icon:De,label:"Fuel Level",value:`${o().fuelLevel}%`,colorClass:o().fuelLevel>20?"text-green-600":"text-red-600"}];Y();var i=Oe(),m=t(i),b=t(m),_=t(b);Me(_,{class:"text-gray-500"}),J(2),e(b),e(m);var f=a(m,2);oe(f,5,()=>r,le,(w,s)=>{var l=He(),c=t(l);Se(c,()=>d(s).icon,(h,C)=>{C(h,{get class(){return d(s).colorClass},size:20})});var v=a(c,2),g=t(v),y=t(g);e(g);var n=a(g,2),u=t(n);e(n),e(v),e(l),M(()=>{p(y,d(s).label),p(u,d(s).value)}),k(w,l)}),e(f),e(i),k(j,i),Q()}var qe=L('<span class="px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm">Demo Mode</span>'),Ie=L('<div class="space-y-6"><div class="flex justify-between items-center"><h1 class="text-2xl font-bold text-gray-900">System Status</h1> <!></div> <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6"><!> <div class="lg:col-span-2 xl:col-span-1"><!></div> <div class="lg:col-span-2 xl:col-span-1"><!></div></div></div>');function dt(j,x){R(x,!1);const o=xe(),r=()=>be(ye,"$isDemoMode",o),i=de();let m=G(x,"data",8);ne();async function b(n){const{type:u,subtype:h,updates:C}=n.detail;if(r())Z(i,{...d(i),[u]:{...d(i)[u],[h]:{...d(i)[u][h],...C}}});else try{if(!(await fetch(`/api/status/${u}/${h}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)})).ok)throw new Error("Failed to update status")}catch($){console.error("Error updating status:",$)}}ie(()=>(d(i),fe(m())),()=>{(n=>Z(i,n.status))(m())}),ve(),Y();var _=Ie(),f=t(_),w=a(t(f),2);X(w,r,n=>{var u=qe();k(n,u)}),e(f);var s=a(f,2),l=t(s);ze(l,{get tanks(){return d(i).tanks}});var c=a(l,2),v=t(c);Ge(v,{get power(){return d(i).power},$$events:{update:b}}),e(c);var g=a(c,2),y=t(g);Ve(y,{get vehicle(){return d(i).vehicle}}),e(g),e(s),e(_),k(j,_),Q()}export{dt as component};
