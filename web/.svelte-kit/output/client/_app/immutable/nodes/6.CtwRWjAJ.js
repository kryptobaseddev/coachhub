import{a as c,t as p,c as ze}from"../chunks/disclose-version.CJFPsRL-.js";import{p as Pe,m as _,g as e,l as J,b as Ae,a as Ge,f as le,t as f,d as n,c as t,s as l,r as o,n as we,e as ie,i as V}from"../chunks/runtime.CUNFE6o5.js";import{e as F,s as P}from"../chunks/render.YXdxLiCJ.js";import{p as Ue,i as W}from"../chunks/props.D6-fppJ3.js";import{e as A,i as G}from"../chunks/Icon.Bvhz2f0e.js";import{c as Ie}from"../chunks/svelte-component.CIsdkGy0.js";import{r as de,s as ke}from"../chunks/index.CnPSb7tb.js";import{s as Je}from"../chunks/class.Cz7S4UMx.js";import{b as ve}from"../chunks/input.BTYOOzm3.js";import{b as X}from"../chunks/select.C4s-v16H.js";import{p as Re}from"../chunks/event-modifiers.CWmzcjye.js";import{i as qe}from"../chunks/lifecycle.CDJD4jvc.js";import{s as Be,a as Ke}from"../chunks/store.BcJSs_Hw.js";import{i as Le}from"../chunks/demoMode.ClaLBl7d.js";import{H as Qe}from"../chunks/house.C213w7pk.js";import{S as Ve,P as We}from"../chunks/server.DeyZbY8g.js";import{S as Xe}from"../chunks/settings.BuYUDVRY.js";var Oe=p('<span class="px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm">Demo Mode</span>'),$e=p('<button type="button"><!> </button>'),ea=p("<option> </option>"),aa=p("<option> </option>"),oa=p("<option> </option>"),ta=p("<option> </option>"),ra=p('<form class="p-6 space-y-6"><div class="grid grid-cols-1 gap-6"><div><label for="coach-name" class="block text-sm font-medium text-gray-700">Coach Name</label> <input id="coach-name" type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" placeholder="My Coach"></div> <div><label for="coach-make" class="block text-sm font-medium text-gray-700">Make</label> <select id="coach-make" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm"><option>Select Make</option><!></select></div> <div><label for="coach-model" class="block text-sm font-medium text-gray-700">Model</label> <select id="coach-model" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm"><option>Select Model</option><!></select></div> <div><label for="coach-year" class="block text-sm font-medium text-gray-700">Year</label> <select id="coach-year" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm"><option>Select Year</option><!></select></div> <div><label for="coach-floorplan" class="block text-sm font-medium text-gray-700">Floorplan</label> <select id="coach-floorplan" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm"><option>Select Floorplan</option><!></select></div></div> <div class="pt-5"><div class="flex justify-end"><button type="submit" class="ml-3 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">Save Changes</button></div></div></form>'),sa=p('<div class="flex items-center justify-between py-2 px-3 bg-gray-50 rounded"><span> </span> <button type="button" class="text-red-600 hover:text-red-800">Remove</button></div>'),na=p('<div class="border rounded-lg p-4"><h3 class="font-medium text-lg mb-3"> </h3> <div class="space-y-2"></div></div>'),la=p('<div class="p-6"><div class="space-y-6"></div></div>'),ia=p('<label class="sr-only">Edit zone name</label> <input type="text" class="rounded-md border-gray-300 shadow-sm">',1),da=p("<span> </span>"),va=p('<div class="flex items-center justify-between py-3 px-4 bg-gray-50 rounded-lg"><!> <div class="flex space-x-2"><button type="button" class="text-gray-600 hover:text-gray-800" aria-label="Edit zone"><!></button> <button type="button" class="text-red-600 hover:text-red-800" aria-label="Delete zone">Delete</button></div></div>'),ca=p('<div class="p-6"><div class="mb-6"><div class="flex space-x-4"><label for="new-zone-name" class="sr-only">New zone name</label> <input id="new-zone-name" type="text" class="flex-1 rounded-md border-gray-300 shadow-sm" placeholder="New zone name"> <button type="button" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Add Zone</button></div></div> <div class="space-y-4"></div></div>'),ma=p('<div class="space-y-6"><div class="flex justify-between items-center"><h1 class="text-2xl font-bold text-gray-900">Coach Configuration</h1> <!></div> <div class="border-b border-gray-200"><nav class="-mb-px flex space-x-8" aria-label="Tabs"></nav></div> <div class="bg-white rounded-lg shadow"><!></div></div>');function Ya(Me,ce){var ge,he,ye,xe;Pe(ce,!1);const Ce=Be(),me=()=>Ke(Le,"$isDemoMode",Ce),R=_(),q=_(),O=_(),$=_(),ee=_(),ae=_();let ue=Ue(ce,"data",8),r=_(ue().coach),pe=ue().configurations,B=_("info"),oe=_(null),K=_("");const Se=[{id:"info",label:"Coach Info",icon:Qe},{id:"devices",label:"Device Groups",icon:Ve},{id:"zones",label:"Zones",icon:We}];let Y=_(((ge=e(r))==null?void 0:ge.make)||""),x=_(((he=e(r))==null?void 0:he.model)||""),g=_(((ye=e(r))==null?void 0:ye.year)||""),E=_(((xe=e(r))==null?void 0:xe.floorplan)||"");function L(){n(r,{...e(r),make:e(Y),model:e(x),year:e(g),floorplan:e(E)}),console.log("Updated coach:",e(r))}function De(a){n(Y,a.target.value),n(x,""),n(g,""),n(E,""),L()}function Fe(a){n(x,a.target.value),n(g,""),n(E,""),L()}function Ye(a){n(g,a.target.value),n(E,""),L()}function Ze(a){n(E,a.target.value),L()}function Ne(){e(K).trim()&&(ie(r,e(r).zones=[...e(r).zones,e(K).trim()]),_e({zones:e(r).zones}),n(K,""))}function Ee(a){ie(r,e(r).zones=e(r).zones.filter(i=>i!==a)),_e({zones:e(r).zones})}async function _e(a){if(me())n(r,{...e(r),...a});else try{if(!(await fetch("/api/admin/coach",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok)throw new Error("Failed to update coach settings")}catch(i){console.error("Error updating coach:",i)}}J(()=>e(Y),()=>{n(R,pe.makes.find(a=>a.name===e(Y)))}),J(()=>(e(R),e(x)),()=>{var a;n(q,(a=e(R))==null?void 0:a.models.find(i=>i.name===e(x)))}),J(()=>(e(q),e(g)),()=>{var a;n(O,(a=e(q))==null?void 0:a.years.find(i=>i.year===e(g)))}),J(()=>e(R),()=>{var a;n($,((a=e(R))==null?void 0:a.models)||[])}),J(()=>e(q),()=>{var a;n(ee,((a=e(q))==null?void 0:a.years)||[])}),J(()=>e(O),()=>{var a;n(ae,((a=e(O))==null?void 0:a.floorplans)||[])}),Ae(),qe();var te=ma(),re=t(te),Te=l(t(re),2);W(Te,me,a=>{var i=Oe();c(a,i)}),o(re);var se=l(re,2),fe=t(se);A(fe,5,()=>Se,G,(a,i)=>{var z=$e(),w=t(z);Ie(w,()=>e(i).icon,(k,M)=>{M(k,{class:"mr-2",size:16})});var h=l(w);o(z),f(()=>{Je(z,`flex items-center py-4 px-1 border-b-2 font-medium text-sm
                        ${(e(B)===e(i).id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300")??""}`),P(h,` ${e(i).label??""}`)}),F("click",z,()=>n(B,e(i).id)),c(a,z)}),o(fe),o(se);var be=l(se,2),je=t(be);W(je,()=>e(B)==="info",a=>{var i=ra(),z=t(i),w=t(z),h=l(t(w),2);de(h),o(w);var k=l(w,2),M=l(t(k),2);f(()=>{e(Y),V(()=>{})});var C=t(M);C.value=((C.__value="")==null,"");var Z=l(C);A(Z,1,()=>pe.makes,G,(v,d)=>{var s=ea(),m={},b=t(s);o(s),f(()=>{m!==(m=e(d).name)&&(s.value=(s.__value=e(d).name)==null?"":e(d).name),P(b,e(d).name)}),c(v,s)}),o(M),o(k);var S=l(k,2),y=l(t(S),2);f(()=>{e(x),V(()=>{e(Y),e($)})});var T=t(y);T.value=((T.__value="")==null,"");var I=l(T);A(I,1,()=>e($),G,(v,d)=>{var s=aa(),m={},b=t(s);o(s),f(()=>{m!==(m=e(d).name)&&(s.value=(s.__value=e(d).name)==null?"":e(d).name),P(b,e(d).name)}),c(v,s)}),o(y),o(S);var N=l(S,2),D=l(t(N),2);f(()=>{e(g),V(()=>{e(x),e(ee)})});var u=t(D);u.value=((u.__value="")==null,"");var U=l(u);A(U,1,()=>e(ee),G,(v,d)=>{var s=oa(),m={},b=t(s);o(s),f(()=>{m!==(m=e(d).year)&&(s.value=(s.__value=e(d).year)==null?"":e(d).year),P(b,e(d).year)}),c(v,s)}),o(D),o(N);var Q=l(N,2),j=l(t(Q),2);f(()=>{e(E),V(()=>{e(g),e(ae)})});var H=t(j);H.value=((H.__value="")==null,"");var ne=l(H);A(ne,1,()=>e(ae),G,(v,d)=>{var s=ta(),m={},b=t(s);o(s),f(()=>{m!==(m=e(d))&&(s.value=(s.__value=e(d))==null?"":e(d)),P(b,e(d))}),c(v,s)}),o(j),o(Q),o(z),we(2),o(i),f(()=>{y.disabled=!e(Y),D.disabled=!e(x),j.disabled=!e(g)}),ve(h,()=>e(r).name,v=>ie(r,e(r).name=v)),X(M,()=>e(Y),v=>n(Y,v)),F("change",M,De),X(y,()=>e(x),v=>n(x,v)),F("change",y,Fe),X(D,()=>e(g),v=>n(g,v)),F("change",D,Ye),X(j,()=>e(E),v=>n(E,v)),F("change",j,Ze),F("submit",i,Re(L)),c(a,i)},a=>{var i=ze(),z=le(i);W(z,()=>e(B)==="devices",w=>{var h=la(),k=t(h);A(k,5,()=>e(r).deviceGroups,G,(M,C)=>{var Z=na(),S=t(Z),y=t(S);o(S);var T=l(S,2);A(T,5,()=>e(C).devices,G,(I,N)=>{var D=sa(),u=t(D),U=t(u);o(u),we(2),o(D),f(()=>P(U,e(N))),c(I,D)}),o(T),o(Z),f(()=>P(y,e(C).name)),c(M,Z)}),o(k),o(h),c(w,h)},w=>{var h=ze(),k=le(h);W(k,()=>e(B)==="zones",M=>{var C=ca(),Z=t(C),S=t(Z),y=l(t(S),2);de(y);var T=l(y,2);o(S),o(Z);var I=l(Z,2);A(I,5,()=>e(r).zones,G,(N,D,u)=>{var U=va(),Q=t(U);W(Q,()=>e(oe)===e(r).zones[u],d=>{var s=ia(),m=le(s),b=l(m,2);de(b),f(()=>{ke(m,"for",`edit-zone-${e(r).zones[u]??""}`),ke(b,"id",`edit-zone-${e(r).zones[u]??""}`)}),ve(b,()=>e(r).zones[u],He=>(e(r).zones[u]=He,V(()=>e(r).zones))),F("blur",b,()=>n(oe,null)),c(d,s)},d=>{var s=da(),m=t(s);o(s),f(()=>P(m,e(r).zones[u])),c(d,s)});var j=l(Q,2),H=t(j),ne=t(H);Xe(ne,{size:16}),o(H);var v=l(H,2);o(j),o(U),F("click",H,()=>n(oe,e(r).zones[u])),F("click",v,()=>Ee(e(r).zones[u])),c(N,U)}),o(I),o(C),ve(y,()=>e(K),N=>n(K,N)),F("click",T,Ne),c(M,C)},null,!0),c(w,h)},!0),c(a,i)}),o(be),o(te),c(Me,te),Ge()}export{Ya as component};
